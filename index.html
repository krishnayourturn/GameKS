<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Krishna Sharma ‚Äî With love from ChatGPT</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg1:#050b1b; --bg2:#07223a;
    --accent:#00e5ff; --accent2:#7b5cff; --accent3:#c787ff;
    --glass: rgba(255,255,255,0.04);
    --muted:#aee9ff88;
    --card-shadow: 0 18px 45px rgba(3,12,22,0.6);
  }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{
    font-family:'Poppins',sans-serif;
    background: linear-gradient(160deg,var(--bg1),var(--bg2));
    color:#e6faff;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    overflow-x:hidden;
  }

  /* Aurora layers */
  .aurora {
    position:fixed; inset:-20% -20% auto auto; width:180%; height:180%; pointer-events:none; z-index:-3;
    background:
      radial-gradient(40% 40% at 20% 30%, rgba(0,230,255,0.12), transparent 15%),
      radial-gradient(50% 50% at 80% 70%, rgba(199,119,255,0.12), transparent 18%),
      radial-gradient(35% 35% at 50% 50%, rgba(127,92,255,0.07), transparent 22%);
    filter: blur(90px);
    animation: auroraShift 28s linear infinite alternate;
  }
  @keyframes auroraShift { from{transform:translate(-8%, -6%) rotate(0)} to{transform:translate(8%,6%) rotate(180deg)} }

  /* Header */
  header{position:fixed;top:14px;left:16px;right:16px;display:flex;justify-content:space-between;align-items:center;z-index:1000;pointer-events:none}
  .brand{pointer-events:auto;padding:8px 14px;border-radius:10px;background:linear-gradient(90deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));box-shadow:0 8px 30px rgba(6,12,22,0.7);border:1px solid rgba(255,255,255,0.03);display:flex;gap:12px;align-items:center}
  .brand h1{font-size:1rem;font-weight:800;margin:0;color:var(--accent)}
  .menu-btn{pointer-events:auto;background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 10px;border-radius:10px;color:var(--accent);cursor:pointer}
  .menu-btn:hover{background:rgba(255,255,255,0.02)}

  /* Intro card */
  main{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px 18px;position:relative}
  .intro {
    width:100%;max-width:980px;padding:44px;border-radius:18px;text-align:center;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    box-shadow:var(--card-shadow);border:1px solid rgba(255,255,255,0.03);
    transform-origin:center;
    animation:introPop .9s cubic-bezier(.2,.9,.2,1) forwards;
  }
  @keyframes introPop { from{opacity:0; transform:translateY(18px) scale(.98)} to{opacity:1; transform:none} }

  .intro .title{
    font-size:3.2rem; font-weight:800; letter-spacing:1px; margin-bottom:6px;
    background:linear-gradient(90deg,var(--accent),var(--accent2),var(--accent3));
    -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent;
    text-shadow:0 0 18px rgba(0,229,255,0.08);
    animation:neon 3s ease-in-out infinite alternate;
  }
  @keyframes neon{ from{text-shadow:0 0 8px rgba(0,229,255,0.18)} to{text-shadow:0 0 28px rgba(199,119,255,0.28)} }
  .intro .subtitle{color:var(--muted); margin-bottom:18px; font-weight:500}

  .intro .cta{margin-top:18px; display:flex; gap:12px; justify-content:center}
  .btn-primary{
    background:linear-gradient(90deg,var(--accent),var(--accent2)); border:none; padding:12px 22px;border-radius:40px; font-weight:700; color:#001726; cursor:pointer; box-shadow:0 12px 36px rgba(0,229,255,0.06);
  }
  .btn-outline{background:transparent;border:1px solid rgba(255,255,255,0.06); color:#dff6ff; padding:12px 18px;border-radius:40px; cursor:pointer}

  /* Dashboard layout (hidden until login) */
  #dashboard { display:none; width:100%; min-height:100vh; padding:64px 48px 120px; position:relative; z-index:10 }
  .dash-top{display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:18px}
  .hello{font-size:1.1rem; color:#dff8ff}
  .dash-grid{display:grid; grid-template-columns:repeat(auto-fit, minmax(260px, 1fr)); gap:20px; margin-top:8px}

  .card{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    padding:18px; border-radius:14px; min-height:160px; display:flex; flex-direction:column; justify-content:space-between;
    border:1px solid rgba(255,255,255,0.03); box-shadow:0 14px 34px rgba(2,10,20,0.6);
    transition:transform .22s, box-shadow .22s;
  }
  .card:hover{transform:translateY(-8px); box-shadow:0 28px 60px rgba(0,0,0,0.6)}
  .card h3{color:#eaffff; margin-bottom:6px}
  .card p{color:#cfefff; font-size:0.95rem}

  /* Full pages (hidden) */
  .full-section{display:none; max-width:980px; margin:0 auto 80px}
  .full-card{padding:18px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.03); box-shadow:var(--card-shadow)}
  .note-area{width:100%;height:200px;padding:12px;border-radius:10px;border:1px dashed rgba(255,255,255,0.04);background:rgba(0,0,0,0.12);color:#dff6ff;resize:vertical}

  /* myFiles list */
  .folder-list{display:flex;flex-direction:column;gap:12px;margin-top:12px}
  .folder-row{display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.03)}
  .tiny{font-size:0.9rem;color:#cfefff}

  /* responsive */
  @media (max-width:840px){
    .intro .title{font-size:2.2rem}
    body{padding-bottom:60px}
  }
</style>
</head>
<body>
  <div class="aurora" aria-hidden="true"></div>

  <header>
    <div class="brand" title="Krishna Sharma">
      <h1>Krishna Sharma</h1>
    </div>
    <div style="display:flex;gap:10px;align-items:center">
      <button class="menu-btn" id="hamburgerBtn" onclick="toggleSide()">‚ò∞</button>
    </div>
  </header>

  <aside id="side" style="position:fixed;right:-320px;top:68px;width:300px;background:linear-gradient(180deg, rgba(5,18,30,0.96), rgba(3,12,22,0.94));padding:16px;border-left:1px solid rgba(255,255,255,0.03);border-radius:8px;z-index:999;transition:right .36s">
    <a href="#" onclick="goHome();toggleSide();return false;" style="display:block;color:#dff6ff;text-decoration:none;padding:8px 10px;border-radius:8px">üè† Home</a>
    <a href="#" onclick="openSection('profileFull');toggleSide();return false;" style="display:block;color:#dff6ff;text-decoration:none;padding:8px 10px;border-radius:8px">üë§ Profile</a>
    <a href="#" onclick="openSection('myFilesFull');toggleSide();return false;" style="display:block;color:#dff6ff;text-decoration:none;padding:8px 10px;border-radius:8px">üìÅ My Files</a>
    <hr style="border:none;border-top:1px solid rgba(255,255,255,0.03);margin:12px 0">
    <div style="color:#cfefff;font-size:0.95rem">Tip: Your data is stored locally (browser). To keep files across devices, you can later connect Firebase or cloud storage.</div>
  </aside>

  <main>
    <!-- INTRO -->
    <section id="introCard" class="intro" aria-labelledby="intro-title">
      <div>
        <div class="title" id="intro-title">Krishna Sharma</div>
        <div class="subtitle">With love from ChatGPT ‚ù§Ô∏è</div>
        <div class="cta">
          <button class="btn-primary" onclick="startLogin()">Login</button>
          <button class="btn-outline" onclick="previewSite()">Preview</button>
        </div>
      </div>
    </section>

  </main>

  <!-- Dashboard -->
  <section id="dashboard" aria-hidden="true">
    <div class="dash-top">
      <div class="hello">Welcome back, <strong id="ownerName">Krishna</strong> ‚Äî choose an option below</div>
      <div style="display:flex;gap:10px">
        <button class="btn-outline" onclick="goHome()">Home</button>
        <button class="btn-outline" onclick="exportAllData()">Export Data</button>
      </div>
    </div>

  <!-- grid of cards -->
  <div class="dash-grid sections-grid">
    <div class="card" id="card-profile">
      <div>
        <h3>üë§ Profile</h3>
        <p><strong>Name:</strong> Krishna Sharma<br><strong>Institute:</strong> PhysicsWallah<br><strong>Enrollment No:</strong> 15</p>
      </div>
      <div style="display:flex;gap:8px" class="card-actions">
        <button class="small-btn ghost" onclick="openSection('profileFull')">Open</button>
      </div>
    </div>

    <div class="card" id="card-games">
      <div><h3>üéÆ Krishna's Games</h3><p>Open your games in new tabs</p></div>
      <div style="display:flex;gap:8px">
        <button class="small-btn" onclick="openExternal('https://chess-eight-xi.vercel.app')">Open Chess</button>
        <button class="small-btn" onclick="openExternal('https://ks-dusky-nine.vercel.app')">Open Other</button>
      </div>
    </div>

    <div class="card" id="card-notepad">
      <div><h3>üìù Notepad</h3><p>Quick notes ‚Äî saved locally in your browser.</p></div>
      <div style="display:flex;gap:8px">
        <button class="small-btn" onclick="openSection('notepadFull')">Open</button>
      </div>
    </div>

    <div class="card" id="card-numbers">
      <div><h3>‚òéÔ∏è Important Numbers</h3><p>Store phone numbers, emergency contacts.</p></div>
      <div style="display:flex;gap:8px">
        <button class="small-btn" onclick="openSection('numbersFull')">Open</button>
      </div>
    </div>

    <div class="card" id="card-personal">
      <div><h3>üîí Personal Details</h3><p>Private notes & info.</p></div>
      <div style="display:flex;gap:8px">
        <button class="small-btn" onclick="openSection('personalFull')">Open</button>
      </div>
    </div>

    <div class="card" id="card-files">
      <div><h3>üìÅ My Files</h3><p>Create folders and upload images; stored locally.</p></div>
      <div style="display:flex;gap:8px">
        <button class="small-btn" onclick="openSection('myFilesFull')">Open</button>
      </div>
    </div>
  </div> <!-- end grid -->

</section> <!-- end dashboard -->
  <!-- ====================== PART 2 CONTINUATION ====================== -->
<!-- Full sections (keeps your original content + working features) -->

<!-- PROFILE FULL -->
<section id="profileFull" class="full-section" aria-hidden="true">
  <div class="full-card">
    <h3>üë§ Profile</h3>
    <p><strong>Name:</strong> Krishna Sharma</p>
    <p><strong>Class:</strong> (Add your class here)</p>
    <p><strong>Enrollment No:</strong> 15</p>
    <p><strong>Institute:</strong> PhysicsWallah</p>
    <p><strong>Registration ID:</strong> 22581624</p>
    <p><strong>Gender:</strong> Male</p>
    <p><strong>Nationality:</strong> India</p>
    <p><strong>Address:</strong> tumhe nahi batana</p>
    <div style="margin-top:12px">
      <button class="small-btn ghost" onclick="openSection('dashboard')">Back</button>
    </div>
  </div>
</section>

<!-- GAMES FULL -->
<section id="gamesFull" class="full-section" aria-hidden="true">
  <div class="full-card">
    <h3>üéÆ Games</h3>
    <p>Open the links below in a new tab:</p>
    <ul style="margin-top:12px;color:#dff6ff">
      <li><a href="https://chess-eight-xi.vercel.app" target="_blank" rel="noopener" style="color:var(--accent)">chess-eight-xi.vercel.app</a></li>
      <li><a href="https://ks-dusky-nine.vercel.app" target="_blank" rel="noopener" style="color:var(--accent)">ks-dusky-nine.vercel.app</a></li>
    </ul>
    <div style="margin-top:12px;text-align:center">
      <button class="small-btn ghost" onclick="openSection('dashboard')">Back</button>
    </div>
  </div>
</section>

<!-- NOTEPAD FULL -->
<section id="notepadFull" class="full-section" aria-hidden="true">
  <div class="full-card">
    <h3>üìù Notepad</h3>
    <textarea id="notepadText" class="note-area" placeholder="Write your notes here..."></textarea>
    <div class="note-controls" style="margin-top:10px">
      <div style="flex:1;color:#cfefff88">Notes autosave when you press Save. They are stored only on this device.</div>
      <div style="display:flex;gap:8px">
        <button class="small-btn ghost" onclick="loadNotepad()">Load</button>
        <button class="small-btn" onclick="saveNotepad()">Save</button>
        <button class="small-btn ghost" onclick="clearNotepad()">Clear</button>
      </div>
    </div>
    <div style="margin-top:12px;text-align:center">
      <button class="small-btn ghost" onclick="openSection('dashboard')">Back</button>
    </div>
  </div>
</section>

<!-- NUMBERS FULL -->
<section id="numbersFull" class="full-section" aria-hidden="true">
  <div class="full-card">
    <h3>‚òéÔ∏è Important Numbers</h3>
    <textarea id="numbersText" class="note-area" placeholder="Add important numbers here..."></textarea>
    <div class="note-controls" style="margin-top:10px">
      <div style="flex:1;color:#cfefff88">Saved locally in your browser.</div>
      <div style="display:flex;gap:8px">
        <button class="small-btn ghost" onclick="loadNumbers()">Load</button>
        <button class="small-btn" onclick="saveNumbers()">Save</button>
        <button class="small-btn ghost" onclick="clearNumbers()">Clear</button>
      </div>
    </div>
    <div style="margin-top:12px;text-align:center">
      <button class="small-btn ghost" onclick="openSection('dashboard')">Back</button>
    </div>
  </div>
</section>

<!-- PERSONAL FULL -->
<section id="personalFull" class="full-section" aria-hidden="true">
  <div class="full-card">
    <h3>üîí Personal Details</h3>
    <textarea id="personalText" class="note-area" placeholder="Write your personal details here..."></textarea>
    <div class="note-controls" style="margin-top:10px">
      <div style="flex:1;color:#cfefff88">Saved locally ‚Äî private to this browser.</div>
      <div style="display:flex;gap:8px">
        <button class="small-btn ghost" onclick="loadPersonal()">Load</button>
        <button class="small-btn" onclick="savePersonal()">Save</button>
        <button class="small-btn ghost" onclick="clearPersonal()">Clear</button>
      </div>
    </div>
    <div style="margin-top:12px;text-align:center">
      <button class="small-btn ghost" onclick="openSection('dashboard')">Back</button>
    </div>
  </div>
</section>

<!-- MY FILES FULL -->
<section id="myFilesFull" class="full-section" aria-hidden="true">
  <div class="full-card">
    <h3>üìÅ My Files</h3>

    <div style="display:flex;gap:8px;align-items:center;margin-top:10px">
      <input id="folderInput" placeholder="New folder name" style="padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#dff6ff;flex:1">
      <button class="small-btn" onclick="createFolderFromInput()">Create Folder</button>
    </div>

    <div class="folder-list" id="foldersList"></div>

    <div style="margin-top:14px;text-align:center">
      <button class="small-btn ghost" onclick="openSection('dashboard')">Back</button>
    </div>
  </div>
</section>

<!-- FOLDER VIEW (images display) -->
<section id="folderView" class="full-section" aria-hidden="true">
  <div class="full-card">
    <h3 id="folderTitle">Folder</h3>
    <div style="display:flex;gap:10px;align-items:center;margin-top:8px">
      <input type="file" id="imagesInput" accept="image/*" multiple>
      <button class="small-btn" onclick="triggerImages()">+ Add Images</button>
      <button class="small-btn ghost" onclick="downloadFolder()">Download Zip</button>
      <button class="small-btn ghost" onclick="deleteFolder()">Delete Folder</button>
    </div>

    <div id="imagesGrid" style="display:flex;flex-wrap:wrap;gap:10px;margin-top:12px"></div>

    <div style="margin-top:12px;text-align:center">
      <button class="small-btn ghost" onclick="openSection('myFilesFull')">Back to Folders</button>
    </div>
  </div>
</section>

<!-- minimal footer -->
<footer style="position:fixed;bottom:8px;left:0;right:0;text-align:center;color:#9fe6ff88;font-size:13px">¬© 2025 Krishna Sharma ‚Äî With love from ChatGPT ‚ù§Ô∏è</footer>
  <!-- ====================== PART 3 ‚Äî SCRIPTS, INTERACTIVITY, EXTRA EFFECTS ====================== -->
<script>
/* ---------------------- Config ---------------------- */
const EXPECTED_PASSWORD = "KSINCREDIBLE";
const FOLDERS_KEY = "krishna_folders_v2"; // key for list of folders

/* ---------------------- Utility ---------------------- */
function toggleSide(){
  const s = document.getElementById('side');
  if(s.style.right && s.style.right !== '-320px'){ s.style.right = '-320px'; }
  else s.style.right = '16px';
}

/* ---------------------- Navigation helpers ---------------------- */
function hideAllFull(){
  document.querySelectorAll('.full-section').forEach(el => el.style.display = 'none');
}
function openSection(id){
  // hide main intro and dashboard, show target
  document.getElementById('introCard').style.display = 'none';
  document.getElementById('dashboard').style.display = 'none';
  hideAllFull();
  const el = document.getElementById(id);
  if(el) el.style.display = 'block';
  window.scrollTo({top:0,behavior:'smooth'});
}
function goHome(){
  hideAllFull();
  document.getElementById('dashboard').style.display = 'block';
  document.getElementById('introCard').style.display = 'none';
  window.scrollTo({top:0,behavior:'smooth'});
}
function previewSite(){
  // show dashboard briefly without password (preview)
  document.getElementById('introCard').style.display='none';
  document.getElementById('dashboard').style.display='block';
}

/* ---------------------- Login ---------------------- */
function startLogin(){
  const pass = prompt("Enter password:");
  if(pass === null) return;
  if(pass === EXPECTED_PASSWORD){
    document.getElementById('introCard').style.display = 'none';
    document.getElementById('dashboard').style.display = 'block';
    // load user-specific items
    renderFolders();
    loadAllNotes();
  } else {
    alert("Wrong password. Access denied.");
  }
}

/* ---------------------- External open ---------------------- */
function openExternal(url){
  window.open(url, '_blank');
}

/* ---------------------- Notepad functions ---------------------- */
function saveNotepad(){
  const v = document.getElementById('notepadText').value;
  localStorage.setItem('krishna_notepad_v2', v);
  alert('Notepad saved locally.');
}
function loadNotepad(){
  const v = localStorage.getItem('krishna_notepad_v2') || '';
  document.getElementById('notepadText').value = v;
  alert('Notepad loaded.');
}
function clearNotepad(){
  if(confirm('Clear notepad?')){
    document.getElementById('notepadText').value = '';
    localStorage.removeItem('krishna_notepad_v2');
  }
}

/* ---------------------- Numbers ---------------------- */
function saveNumbers(){
  const v = document.getElementById('numbersText').value;
  localStorage.setItem('krishna_numbers_v2', v);
  alert('Important numbers saved.');
}
function loadNumbers(){
  const v = localStorage.getItem('krishna_numbers_v2') || '';
  document.getElementById('numbersText').value = v;
  alert('Important numbers loaded.');
}
function clearNumbers(){
  if(confirm('Clear important numbers?')){
    document.getElementById('numbersText').value = '';
    localStorage.removeItem('krishna_numbers_v2');
  }
}

/* ---------------------- Personal ---------------------- */
function savePersonal(){
  const v = document.getElementById('personalText').value;
  localStorage.setItem('krishna_personal_v2', v);
  alert('Personal details saved.');
}
function loadPersonal(){
  const v = localStorage.getItem('krishna_personal_v2') || '';
  document.getElementById('personalText').value = v;
  alert('Personal details loaded.');
}
function clearPersonal(){
  if(confirm('Clear personal details?')){
    document.getElementById('personalText').value = '';
    localStorage.removeItem('krishna_personal_v2');
  }
}

/* ---------------------- Folders & Files (My Files) ---------------------- */
function getFolders(){
  try{
    return JSON.parse(localStorage.getItem(FOLDERS_KEY) || '[]');
  }catch(e){ return []; }
}
function saveFolders(list){
  localStorage.setItem(FOLDERS_KEY, JSON.stringify(list));
}

function createFolderFromInput(){
  const name = (document.getElementById('folderInput').value || '').trim();
  if(!name) { alert('Enter a folder name.'); return; }
  createFolder(name);
  document.getElementById('folderInput').value = '';
}

function createFolder(name){
  const list = getFolders();
  if(list.includes(name)) { alert('Folder already exists'); return; }
  list.push(name);
  saveFolders(list);
  // create storage for images
  localStorage.setItem(folderKey(name), JSON.stringify([]));
  renderFolders();
}

function folderKey(name){ return 'ks_folder_v2::' + name; }

function renderFolders(){
  const container = document.getElementById('foldersList');
  container.innerHTML = '';
  const list = getFolders();
  if(list.length === 0){
    const p = document.createElement('p'); p.style.opacity = '0.75'; p.innerText = 'No folders yet ‚Äî create one!';
    container.appendChild(p); return;
  }
  list.forEach(name => {
    const row = document.createElement('div');
    row.className = 'folder-row';
    row.innerHTML = `<div>
        <div style="font-weight:700">${name}</div>
        <div class="tiny">Images: <span id="count-${escapeId(name)}">0</span></div>
      </div>
      <div style="display:flex;gap:8px">
        <button class="small-btn" onclick="openFolder('${escapeSingle(name)}')">Open</button>
        <button class="small-btn ghost" onclick="renameFolderPrompt('${escapeSingle(name)}')">Rename</button>
        <button class="small-btn ghost" onclick="deleteFolderPrompt('${escapeSingle(name)}')">Delete</button>
      </div>`;
    container.appendChild(row);
    // update count
    const imgs = JSON.parse(localStorage.getItem(folderKey(name)) || '[]');
    const el = document.getElementById('count-'+escapeId(name));
    if(el) el.textContent = imgs.length;
  });
}

/* sanitation for id */
function escapeId(s){ return btoa(unescape(encodeURIComponent(s))).replace(/=/g,''); }
function escapeSingle(s){ return s.replace(/'/g,"\\'").replace(/"/g,'\\"'); }

function openFolder(name){
  // show folderView and list images
  openSection('folderView');
  document.getElementById('folderTitle').textContent = name;
  currentFolder = name;
  renderImages();
}

function triggerImages(){
  document.getElementById('imagesInput').click();
}

let currentFolder = null;
document.getElementById('imagesInput').addEventListener('change', (e) => {
  handleImageFiles(e.target.files);
});

function handleImageFiles(files){
  if(!currentFolder) { alert('Open a folder first'); return; }
  const arr = JSON.parse(localStorage.getItem(folderKey(currentFolder)) || '[]');
  const fileList = Array.from(files);
  fileList.forEach(f => {
    const reader = new FileReader();
    reader.onload = () => {
      arr.push(reader.result);
      localStorage.setItem(folderKey(currentFolder), JSON.stringify(arr));
      renderImages();
      renderFolders(); // update counts
    };
    reader.readAsDataURL(f);
  });
}

function renderImages(){
  const grid = document.getElementById('imagesGrid');
  grid.innerHTML = '';
  if(!currentFolder) return;
  const arr = JSON.parse(localStorage.getItem(folderKey(currentFolder)) || '[]');
  if(arr.length === 0){ grid.innerHTML = '<div style="opacity:0.75">No images yet. Add some!</div>'; return; }
  arr.forEach((src, idx) => {
    const wrap = document.createElement('div');
    wrap.style = 'width:120px;border-radius:8px;overflow:hidden;position:relative';
    const img = document.createElement('img');
    img.src = src; img.style.width='120px'; img.style.height='80px'; img.style.objectFit='cover';
    img.alt = 'img';
    const del = document.createElement('button');
    del.innerText = '‚úï'; del.title='Delete image';
    del.style = 'position:absolute;top:6px;right:6px;background:rgba(0,0,0,0.5);color:#fff;border:none;border-radius:6px;padding:3px;cursor:pointer';
    del.onclick = ()=> { if(confirm('Delete this image?')) { removeImageAt(idx); } };
    const dl = document.createElement('button');
    dl.innerText = '‚Üì'; dl.title='Download'; dl.style = 'position:absolute;bottom:6px;left:6px;background:rgba(0,0,0,0.5);color:#fff;border:none;border-radius:6px;padding:4px;cursor:pointer';
    dl.onclick = ()=> downloadDataURL(src, `${currentFolder}-${idx}.png`);
    wrap.appendChild(img); wrap.appendChild(del); wrap.appendChild(dl);
    grid.appendChild(wrap);
  });
}

function removeImageAt(index){
  const arr = JSON.parse(localStorage.getItem(folderKey(currentFolder)) || '[]');
  arr.splice(index,1);
  localStorage.setItem(folderKey(currentFolder), JSON.stringify(arr));
  renderImages(); renderFolders();
}

function deleteFolderPrompt(name){
  if(!confirm(`Delete folder "${name}" and all images? This cannot be undone.`)) return;
  deleteFolderByName(name);
}

function deleteFolderByName(name){
  let list = getFolders();
  list = list.filter(x=>x!==name);
  saveFolders(list);
  localStorage.removeItem(folderKey(name));
  renderFolders();
  openSection('myFilesFull');
}

function deleteFolder(){
  if(!currentFolder) return;
  if(confirm(`Delete folder "${currentFolder}"?`)){
    deleteFolderByName(currentFolder);
  }
}

/* rename folder */
function renameFolderPrompt(name){
  const n = prompt('New folder name:', name);
  if(!n || n.trim()==='') return;
  const list = getFolders();
  if(list.includes(n.trim())){ alert('Folder with this name exists'); return; }
  // copy images
  const imgs = JSON.parse(localStorage.getItem(folderKey(name)) || '[]');
  localStorage.setItem(folderKey(n.trim()), JSON.stringify(imgs));
  // remove old
  localStorage.removeItem(folderKey(name));
  // update list
  const newList = list.map(x => x===name ? n.trim() : x);
  saveFolders(newList); renderFolders();
}

/* download helper (single image) */
function downloadDataURL(dataURL, filename){
  const a = document.createElement('a');
  a.href = dataURL;
  a.download = filename;
  document.body.appendChild(a); a.click(); a.remove();
}

/* download folder as zip (simple fallback: downloads each image single clicks) */
function downloadFolder(){
  const arr = JSON.parse(localStorage.getItem(folderKey(currentFolder)) || '[]');
  if(arr.length === 0){ alert('No images to download'); return; }
  // create temporary links sequentially (browser will prompt for each)
  arr.forEach((d, i) => {
    downloadDataURL(d, `${currentFolder}-${i+1}.png`);
  });
}

/* ---------------------- Export / Import data ---------------------- */
function exportAllData(){
  const data = {
    folders: getFolders().reduce((acc, f) => {
      acc[f] = JSON.parse(localStorage.getItem(folderKey(f)) || '[]'); return acc;
    }, {}),
    notes: {
      notepad: localStorage.getItem('krishna_notepad_v2') || '',
      numbers: localStorage.getItem('krishna_numbers_v2') || '',
      personal: localStorage.getItem('krishna_personal_v2') || ''
    }
  };
  const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download = 'krishna_backup.json'; document.body.appendChild(a); a.click(); a.remove();
  URL.revokeObjectURL(url);
}

/* ---------------------- Load initial data ---------------------- */
function loadAllNotes(){
  const np = localStorage.getItem('krishna_notepad_v2');
  if(np) document.getElementById('notepadText').value = np;
  const nm = localStorage.getItem('krishna_numbers_v2');
  if(nm) document.getElementById('numbersText').value = nm;
  const pp = localStorage.getItem('krishna_personal_v2');
  if(pp) document.getElementById('personalText').value = pp;
}

/* ---------------------- small game (keeps you happy) ---------------------- */
function playGame(){
  const r = Math.random();
  const el = document.getElementById('gameResult');
  if(!el) return;
  el.innerText = r>0.66 ? 'Jackpot! üéâ' : (r>0.33 ? 'Nice! üëç' : 'Try again üòÖ');
}

/* ---------------------- AI assistant bubble (simple) ---------------------- */
(function createAssistant(){
  const bubble = document.createElement('div');
  bubble.id = 'assistantBubble';
  bubble.style = 'position:fixed;right:18px;bottom:80px;width:260px;padding:12px;border-radius:12px;background:linear-gradient(180deg,rgba(0,0,0,0.6),rgba(3,12,22,0.8));box-shadow:0 12px 40px rgba(0,0,0,0.6);color:#dff6ff;z-index:1000;backdrop-filter:blur(8px);';
  bubble.innerHTML = `<div style="display:flex;align-items:center;gap:10px">
      <div style="width:46px;height:46px;border-radius:10px;background:linear-gradient(90deg,var(--accent),var(--accent2));box-shadow:0 8px 24px rgba(0,229,255,0.12);display:flex;align-items:center;justify-content:center;font-weight:800;color:#001726">KS</div>
      <div style="flex:1"><div style="font-weight:700">Hey Krishna üëã</div><div style="font-size:13px;color:#aee9ff88">Need files or want to create a new folder?</div></div>
    </div>
    <div style="display:flex;gap:8px;margin-top:8px">
      <button class="small-btn" onclick="openSection('myFilesFull')">Open My Files</button>
      <button class="small-btn ghost" onclick="openSection('notepadFull')">Notepad</button>
    </div>`;
  document.body.appendChild(bubble);

  // pleasant pop-in
  bubble.animate([{ transform:'translateY(18px)', opacity:0 }, { transform:'translateY(0)', opacity:1 }], { duration:600, easing:'cubic-bezier(.2,.9,.2,1)'});
})();

/* ---------------------- Cursor particles (subtle) ---------------------- */
(function cursorTrail(){
  const area = document.createElement('div'); area.style = 'position:fixed;left:0;top:0;right:0;bottom:0;pointer-events:none;z-index:0';
  document.body.appendChild(area);
  const particles = [];
  document.addEventListener('pointermove', e=>{
    const p = document.createElement('div');
    p.style.position='absolute';
    p.style.left = (e.clientX-6)+'px';
    p.style.top = (e.clientY-6)+'px';
    p.style.width='10px'; p.style.height='10px';
    p.style.borderRadius='50%';
    p.style.background = 'radial-gradient(circle, rgba(0,229,255,0.9), rgba(127,92,255,0.6))';
    p.style.opacity='0.9';
    p.style.transition='transform 700ms linear, opacity 700ms linear';
    area.appendChild(p);
    requestAnimationFrame(()=> p.style.transform='scale(4) translateY(-8px)', p.style.opacity='0');
    setTimeout(()=> p.remove(), 750);
  });
})();

/* ---------------------- init render ---------------------- */
(function init(){
  renderFolders();
  loadAllNotes();
})();
</script>
</body>
</html>
